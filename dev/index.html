<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generic Coordinate Transformation Library (PROJ) C API • libproj</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Generic Coordinate Transformation Library (PROJ) C API">
<meta property="og:description" content="Provides a PROJ &lt;https://proj.org&gt; C API that can be 
  used to write high-performance C and C++ coordinate transformation
  operations using R as an interface. This package contains an internal 
  version of the PROJ library to guarantee the best possible 
  consistency on multiple platforms, and to provide a means by which
  PROJ can be used on platforms where it may be impractical
  or impossible to install a binary version of the library.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">libproj</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">8.1.0-0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paleolimbot/libproj/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="libproj" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#libproj" class="anchor"></a>libproj</h1></div>
<!-- badges: start -->

<p>The goal of libproj is to provide access to the <a href="https://proj.org">PROJ</a> C API for high-performance geometry operations within the R package framework. This package contains a copy of the PROJ library, modified slightly to eliminate errors on all the platforms checked by CRAN and GitHub actions. This means you don’t have to install anything (other than the package) to take advantage of PROJ functions in R. It also means you don’t need a configure script if you’re writing a package that needs PROJ functionality (just <code>LinkingTo: libproj</code>).</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of libproj from <a href="https://cran.r-project.org/">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"libproj"</span><span class="op">)</span></code></pre></div>
<p>To install a binary on supported Linux platforms, you can use <a href="https://packagemanager.rstudio.com/">RStudio Package Manager’s public instance</a> (see <a href="https://packagemanager.rstudio.com/client/#/repos/1/overview">here</a> for how to configure on your platform).</p>
<p>You can install the development version from <a href="https://r-universe.dev/">R Universe</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"libproj"</span>, repos <span class="op">=</span> <span class="st">"https://paleolimbot.r-universe.dev"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This package only exists for its exported C API. You can use it interactively (if using Rcpp use <code>// [[Rcpp::depends(libproj)]]</code>; if using cpp11 use <code>[[cpp11::linking_to(libproj)]]</code> to decorate at least one function) or by adding <code>libproj</code> to the <code>LinkingTo</code> field of a dependency package. The libproj package does some minimal configuration on the <code>PJ_DEFAULT_CTX</code> context so that it’s safe to use; however, you might want to use <code>proj_context_clone()</code> to create a new one and configure it to your liking (e.g., turn networking on or point it to a cusom data directory).</p>
<p>An example using <a href="https://cpp11.r-lib.org">cpp11</a>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="pp">#include </span><span class="im">&lt;cpp11.hpp&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">using</span> <span class="kw">namespace</span> cpp11;</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">// needed in every file that uses proj_*() functions</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="pp">#include </span><span class="im">"libproj.h"</span></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">// needed exactly once in your package or Rcpp script</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">// contains all the function pointers and the</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">// implementation of the function to initialize them</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">// (`libproj_init_api()`)</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="pp">#include </span><span class="im">"libproj.c"</span></span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">// this function needs to be called once before any proj_*() functions</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">// are called (e.g., in .onLoad() for your package)</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>[[<span class="at">cpp11</span>::<span class="at">linking_to</span>(<span class="at">libproj</span>)]]</span>
<span id="cb3-16"><a href="#cb3-16"></a>[[<span class="at">cpp11</span>::<span class="at">register</span>]]</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="dt">void</span> cpp_libproj_init_api() {</span>
<span id="cb3-18"><a href="#cb3-18"></a>  libproj_init_api();</span>
<span id="cb3-19"><a href="#cb3-19"></a>}</span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">// regular C or C++ code that uses proj_()* functions!</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>[[<span class="at">cpp11</span>::<span class="at">register</span>]]</span>
<span id="cb3-23"><a href="#cb3-23"></a>list proj_coords(list xy, <span class="bu">std::</span>string from, <span class="bu">std::</span>string to) {</span>
<span id="cb3-24"><a href="#cb3-24"></a>  doubles x = xy[<span class="dv">0</span>];</span>
<span id="cb3-25"><a href="#cb3-25"></a>  doubles y = xy[<span class="dv">1</span>];</span>
<span id="cb3-26"><a href="#cb3-26"></a>  </span>
<span id="cb3-27"><a href="#cb3-27"></a>  PJ_CONTEXT* context = PJ_DEFAULT_CTX;</span>
<span id="cb3-28"><a href="#cb3-28"></a>  </span>
<span id="cb3-29"><a href="#cb3-29"></a>  PJ* trans = proj_create_crs_to_crs(context, from.c_str(), to.c_str(), NULL);</span>
<span id="cb3-30"><a href="#cb3-30"></a>  <span class="cf">if</span> (trans == NULL) {</span>
<span id="cb3-31"><a href="#cb3-31"></a>    <span class="dt">int</span> error_code = proj_context_errno(context);</span>
<span id="cb3-32"><a href="#cb3-32"></a>    stop(<span class="st">"Error creating transform: </span><span class="sc">%s</span><span class="st">"</span>, proj_context_errno_string(context, error_code));</span>
<span id="cb3-33"><a href="#cb3-33"></a>  }</span>
<span id="cb3-34"><a href="#cb3-34"></a>  </span>
<span id="cb3-35"><a href="#cb3-35"></a>  writable::doubles xout(x);</span>
<span id="cb3-36"><a href="#cb3-36"></a>  writable::doubles yout(y);</span>
<span id="cb3-37"><a href="#cb3-37"></a>  <span class="dt">size_t</span> stride = <span class="kw">sizeof</span>(<span class="dt">double</span>);</span>
<span id="cb3-38"><a href="#cb3-38"></a>  </span>
<span id="cb3-39"><a href="#cb3-39"></a>  proj_trans_generic(</span>
<span id="cb3-40"><a href="#cb3-40"></a>    trans, PJ_FWD,</span>
<span id="cb3-41"><a href="#cb3-41"></a>    REAL(xout), stride, xout.size(),</span>
<span id="cb3-42"><a href="#cb3-42"></a>    REAL(yout), stride, yout.size(),</span>
<span id="cb3-43"><a href="#cb3-43"></a>    <span class="kw">nullptr</span>, stride, <span class="dv">0</span>,</span>
<span id="cb3-44"><a href="#cb3-44"></a>    <span class="kw">nullptr</span>, stride, <span class="dv">0</span></span>
<span id="cb3-45"><a href="#cb3-45"></a>  );</span>
<span id="cb3-46"><a href="#cb3-46"></a>  </span>
<span id="cb3-47"><a href="#cb3-47"></a>  <span class="dt">int</span> error_code = proj_errno(trans);</span>
<span id="cb3-48"><a href="#cb3-48"></a>  proj_destroy(trans);</span>
<span id="cb3-49"><a href="#cb3-49"></a>  </span>
<span id="cb3-50"><a href="#cb3-50"></a>  <span class="cf">if</span> (error_code != <span class="dv">0</span>) {</span>
<span id="cb3-51"><a href="#cb3-51"></a>    stop(<span class="st">"Error transforming coords: </span><span class="sc">%s</span><span class="st">"</span>, proj_context_errno_string(context, error_code));</span>
<span id="cb3-52"><a href="#cb3-52"></a>  }</span>
<span id="cb3-53"><a href="#cb3-53"></a>  </span>
<span id="cb3-54"><a href="#cb3-54"></a>  writable::list out = {xout, yout};</span>
<span id="cb3-55"><a href="#cb3-55"></a>  out.names() = {<span class="st">"x"</span>, <span class="st">"y"</span>};</span>
<span id="cb3-56"><a href="#cb3-56"></a>  <span class="cf">return</span> out;</span>
<span id="cb3-57"><a href="#cb3-57"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpp_libproj_init_api</span><span class="op">(</span><span class="op">)</span>
<span class="fu">proj_coords</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">64</span>, <span class="fl">45</span><span class="op">)</span>, <span class="st">"+proj=longlat"</span>, <span class="st">"EPSG:32620"</span><span class="op">)</span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt; [1] 421184.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $y</span>
<span class="co">#&gt; [1] 4983437</span></code></pre></div>
<p>An example using <a href="https://cpp11.r-lib.org">Rcpp</a>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">// [[Rcpp::depends(libproj)]]</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="pp">#include </span><span class="im">"libproj.h"</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="pp">#include </span><span class="im">"libproj.c"</span></span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="dt">void</span> cpp_libproj_init_api() {</span>
<span id="cb5-10"><a href="#cb5-10"></a>  libproj_init_api();</span>
<span id="cb5-11"><a href="#cb5-11"></a>}</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>List proj_coords(List xy, <span class="bu">std::</span>string from, <span class="bu">std::</span>string to) {</span>
<span id="cb5-15"><a href="#cb5-15"></a>  NumericVector x = xy[<span class="dv">0</span>];</span>
<span id="cb5-16"><a href="#cb5-16"></a>  NumericVector y = xy[<span class="dv">1</span>];</span>
<span id="cb5-17"><a href="#cb5-17"></a>  </span>
<span id="cb5-18"><a href="#cb5-18"></a>  PJ_CONTEXT* context = PJ_DEFAULT_CTX;</span>
<span id="cb5-19"><a href="#cb5-19"></a>  </span>
<span id="cb5-20"><a href="#cb5-20"></a>  PJ* trans = proj_create_crs_to_crs(context, from.c_str(), to.c_str(), NULL);</span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="cf">if</span> (trans == NULL) {</span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="dt">int</span> errorCode = proj_context_errno(context);</span>
<span id="cb5-23"><a href="#cb5-23"></a>    <span class="bu">std::</span>stringstream err;</span>
<span id="cb5-24"><a href="#cb5-24"></a>    err &lt;&lt; <span class="st">"Error creating transform: "</span> &lt;&lt; proj_context_errno_string(context, errorCode);</span>
<span id="cb5-25"><a href="#cb5-25"></a>    stop(err.str());</span>
<span id="cb5-26"><a href="#cb5-26"></a>  }</span>
<span id="cb5-27"><a href="#cb5-27"></a>  </span>
<span id="cb5-28"><a href="#cb5-28"></a>  NumericVector xout = clone(x);</span>
<span id="cb5-29"><a href="#cb5-29"></a>  NumericVector yout = clone(y);</span>
<span id="cb5-30"><a href="#cb5-30"></a>  <span class="dt">size_t</span> stride = <span class="kw">sizeof</span>(<span class="dt">double</span>);</span>
<span id="cb5-31"><a href="#cb5-31"></a>  </span>
<span id="cb5-32"><a href="#cb5-32"></a>  proj_trans_generic(</span>
<span id="cb5-33"><a href="#cb5-33"></a>    trans, PJ_FWD,</span>
<span id="cb5-34"><a href="#cb5-34"></a>    &amp;(xout[<span class="dv">0</span>]), stride, xout.size(),</span>
<span id="cb5-35"><a href="#cb5-35"></a>    &amp;(yout[<span class="dv">0</span>]), stride, yout.size(),</span>
<span id="cb5-36"><a href="#cb5-36"></a>    <span class="kw">nullptr</span>, stride, <span class="dv">0</span>,</span>
<span id="cb5-37"><a href="#cb5-37"></a>    <span class="kw">nullptr</span>, stride, <span class="dv">0</span></span>
<span id="cb5-38"><a href="#cb5-38"></a>  );</span>
<span id="cb5-39"><a href="#cb5-39"></a>  </span>
<span id="cb5-40"><a href="#cb5-40"></a>  <span class="dt">int</span> errorCode = proj_errno(trans);</span>
<span id="cb5-41"><a href="#cb5-41"></a>  proj_destroy(trans);</span>
<span id="cb5-42"><a href="#cb5-42"></a>  </span>
<span id="cb5-43"><a href="#cb5-43"></a>  <span class="cf">if</span> (errorCode != <span class="dv">0</span>) {</span>
<span id="cb5-44"><a href="#cb5-44"></a>    <span class="bu">std::</span>stringstream err;</span>
<span id="cb5-45"><a href="#cb5-45"></a>    err &lt;&lt; <span class="st">"Error transforming coords: "</span> &lt;&lt; proj_context_errno_string(context, errorCode);</span>
<span id="cb5-46"><a href="#cb5-46"></a>    stop(err.str());</span>
<span id="cb5-47"><a href="#cb5-47"></a>  }</span>
<span id="cb5-48"><a href="#cb5-48"></a>  </span>
<span id="cb5-49"><a href="#cb5-49"></a>  <span class="cf">return</span> List::create(_[<span class="st">"x"</span>] = xout, _[<span class="st">"y"</span>]  = yout);</span>
<span id="cb5-50"><a href="#cb5-50"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpp_libproj_init_api</span><span class="op">(</span><span class="op">)</span>
<span class="fu">proj_coords</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">64</span>, <span class="fl">45</span><span class="op">)</span>, <span class="st">"+proj=longlat"</span>, <span class="st">"EPSG:32620"</span><span class="op">)</span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt; [1] 421184.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $y</span>
<span class="co">#&gt; [1] 4983437</span></code></pre></div>
<p>You can also link to libproj directly from C:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1"></a><span class="pp">#include </span><span class="im">&lt;R.h&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="pp">#include </span><span class="im">&lt;Rinternals.h&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="pp">#include </span><span class="im">"libproj.h"</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="pp">#include </span><span class="im">"libproj.c"</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="pp">#include </span><span class="im">&lt;memory.h&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a>SEXP c_libproj_init_api() {</span>
<span id="cb7-10"><a href="#cb7-10"></a>  libproj_init_api();</span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="cf">return</span> R_NilValue;</span>
<span id="cb7-12"><a href="#cb7-12"></a>}</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a>SEXP proj_coords(SEXP xy, SEXP from, SEXP to) {</span>
<span id="cb7-15"><a href="#cb7-15"></a>  R_xlen_t n = Rf_xlength(VECTOR_ELT(xy, <span class="dv">0</span>));</span>
<span id="cb7-16"><a href="#cb7-16"></a>  SEXP xout = PROTECT(Rf_allocVector(REALSXP, n));</span>
<span id="cb7-17"><a href="#cb7-17"></a>  SEXP yout = PROTECT(Rf_allocVector(REALSXP, n));</span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a>  <span class="dt">double</span>* x = REAL(VECTOR_ELT(xy, <span class="dv">0</span>));</span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="dt">double</span>* y = REAL(VECTOR_ELT(xy, <span class="dv">1</span>));</span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a>  <span class="dt">const</span> <span class="dt">char</span>* from_c = Rf_translateCharUTF8(STRING_ELT(from, <span class="dv">0</span>));</span>
<span id="cb7-23"><a href="#cb7-23"></a>  <span class="dt">const</span> <span class="dt">char</span>* to_c = Rf_translateCharUTF8(STRING_ELT(to, <span class="dv">0</span>));</span>
<span id="cb7-24"><a href="#cb7-24"></a></span>
<span id="cb7-25"><a href="#cb7-25"></a>  PJ_CONTEXT* context = PJ_DEFAULT_CTX;</span>
<span id="cb7-26"><a href="#cb7-26"></a></span>
<span id="cb7-27"><a href="#cb7-27"></a>  PJ* trans = proj_create_crs_to_crs(context, from_c, to_c, NULL);</span>
<span id="cb7-28"><a href="#cb7-28"></a>  <span class="cf">if</span> (trans == NULL) {</span>
<span id="cb7-29"><a href="#cb7-29"></a>    <span class="dt">int</span> errorCode = proj_context_errno(context);</span>
<span id="cb7-30"><a href="#cb7-30"></a>    Rf_error(<span class="st">"Error creating transform: %s"</span>, proj_context_errno_string(context, errorCode));</span>
<span id="cb7-31"><a href="#cb7-31"></a>  }</span>
<span id="cb7-32"><a href="#cb7-32"></a></span>
<span id="cb7-33"><a href="#cb7-33"></a>  <span class="dt">size_t</span> stride = <span class="kw">sizeof</span>(<span class="dt">double</span>);</span>
<span id="cb7-34"><a href="#cb7-34"></a>  memcpy(REAL(xout), x, n * <span class="kw">sizeof</span>(<span class="dt">double</span>));</span>
<span id="cb7-35"><a href="#cb7-35"></a>  memcpy(REAL(yout), y, n * <span class="kw">sizeof</span>(<span class="dt">double</span>));</span>
<span id="cb7-36"><a href="#cb7-36"></a></span>
<span id="cb7-37"><a href="#cb7-37"></a>  proj_trans_generic(</span>
<span id="cb7-38"><a href="#cb7-38"></a>    trans, PJ_FWD,</span>
<span id="cb7-39"><a href="#cb7-39"></a>    REAL(xout), stride, n,</span>
<span id="cb7-40"><a href="#cb7-40"></a>    REAL(yout), stride, n,</span>
<span id="cb7-41"><a href="#cb7-41"></a>    NULL, stride, <span class="dv">0</span>,</span>
<span id="cb7-42"><a href="#cb7-42"></a>    NULL, stride, <span class="dv">0</span></span>
<span id="cb7-43"><a href="#cb7-43"></a>  );</span>
<span id="cb7-44"><a href="#cb7-44"></a></span>
<span id="cb7-45"><a href="#cb7-45"></a>  <span class="dt">int</span> errorCode = proj_errno(trans);</span>
<span id="cb7-46"><a href="#cb7-46"></a>  proj_destroy(trans);</span>
<span id="cb7-47"><a href="#cb7-47"></a></span>
<span id="cb7-48"><a href="#cb7-48"></a>  <span class="cf">if</span> (errorCode != <span class="dv">0</span>) {</span>
<span id="cb7-49"><a href="#cb7-49"></a>    Rf_error(<span class="st">"Error transforming coords: %s"</span>, proj_context_errno_string(context, errorCode));</span>
<span id="cb7-50"><a href="#cb7-50"></a>  }</span>
<span id="cb7-51"><a href="#cb7-51"></a></span>
<span id="cb7-52"><a href="#cb7-52"></a>  <span class="dt">const</span> <span class="dt">char</span>* names[] = {<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">""</span>};</span>
<span id="cb7-53"><a href="#cb7-53"></a>  SEXP out = PROTECT(Rf_mkNamed(VECSXP, names));</span>
<span id="cb7-54"><a href="#cb7-54"></a>  SET_VECTOR_ELT(out, <span class="dv">0</span>, xout);</span>
<span id="cb7-55"><a href="#cb7-55"></a>  SET_VECTOR_ELT(out, <span class="dv">1</span>, yout);</span>
<span id="cb7-56"><a href="#cb7-56"></a>  UNPROTECT(<span class="dv">3</span>);</span>
<span id="cb7-57"><a href="#cb7-57"></a>  </span>
<span id="cb7-58"><a href="#cb7-58"></a>  <span class="cf">return</span> out;</span>
<span id="cb7-59"><a href="#cb7-59"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/CallExternal.html">.Call</a></span><span class="op">(</span><span class="st">"c_libproj_init_api"</span><span class="op">)</span>
<span class="co">#&gt; NULL</span>
<span class="fu"><a href="https://rdrr.io/r/base/CallExternal.html">.Call</a></span><span class="op">(</span><span class="st">"proj_coords"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">64</span>, <span class="fl">45</span><span class="op">)</span>, <span class="st">"+proj=longlat"</span>, <span class="st">"EPSG:32620"</span><span class="op">)</span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt; [1] 421184.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $y</span>
<span class="co">#&gt; [1] 4983437</span></code></pre></div>
</div>
<div id="configuration" class="section level2">
<h2 class="hasAnchor">
<a href="#configuration" class="anchor"></a>Configuration</h2>
<p>The libproj package encourages downstream packages to create their own <code>PJ_CONTEXT</code> and configure it to their liking. The default configuration is designed to point to a valid database with a valid (but temporary) writable directory that can be used to store network downloads if networking is turned on.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/libproj/">libproj</a></span><span class="op">)</span>
<span class="fu"><a href="reference/libproj_version.html">libproj_configuration</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; $db_path</span>
<span class="co">#&gt; [1] "/private/var/folders/bq/2rcjstv90nx1_wrt8d3gqw6m0000gn/T/Rtmpe1RiQ7/temp_libpatha7c6437f5665/libproj/proj/proj.db"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $search_path</span>
<span class="co">#&gt; [1] "/private/var/folders/bq/2rcjstv90nx1_wrt8d3gqw6m0000gn/T/Rtmpe1RiQ7/temp_libpatha7c6437f5665/libproj/proj"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $network_endpoint</span>
<span class="co">#&gt; [1] "https://cdn.proj.org"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ca_bundle_path</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $network_enabled</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_writable_dir</span>
<span class="co">#&gt; [1] "/var/folders/bq/2rcjstv90nx1_wrt8d3gqw6m0000gn/T//RtmpbXaDo2/fileab215fcd90ff"</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=libproj">https://​cloud.r-project.org/​package=libproj</a>
</li>
<li>Browse source code at <br><a href="https://github.com/paleolimbot/libproj/">https://​github.com/​paleolimbot/​libproj/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/paleolimbot/libproj/issues">https://​github.com/​paleolimbot/​libproj/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Dewey Dunnington <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9415-4582" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>PROJ authors <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Dewey Dunnington, PROJ authors.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
